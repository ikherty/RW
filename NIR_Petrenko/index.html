<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2018 (Released Feb 1, 2018) -->
<HTML>
<HEAD>
<TITLE>NIR_Petrenko</TITLE>
<META NAME="description" CONTENT="NIR_Petrenko">
<META NAME="keywords" CONTENT="NIR_Petrenko">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="Generator" CONTENT="LaTeX2HTML v2018">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="NIR_Petrenko.css">

</HEAD>

<BODY >

<P>
page
figure
table

<P>

<P>

<DIV ALIGN="CENTER">
<SMALL CLASS="SMALL"><SPAN  CLASS="textbf">МИНИСТЕРСТВО НАУКИ И ВЫСШЕГО ОБРАЗОВАНИЯ РОССИЙСКОЙ ФЕДЕРАЦИИ</SPAN>
<BR>ФЕДЕРАЛЬНОЕ ГОСУДАРСТВЕННОЕ АВТОНОМНОЕ ОБРАЗОВАТЕЛЬНОЕ УЧРЕЖДЕНИЕ
ВЫСШЕГО  ОБРАЗОВАНИЯ
<BR>«Национальный исследовательский ядерный университет «МИФИ»
<BR><SPAN  CLASS="textbf">Обнинский институт атомной энергетики</SPAN> – 
<BR>филиал федерального государственного автономного образовательного учреждения высшего
<BR>образования «Национальный исследовательский ядерный университет «МИФИ»
<BR>(ИАТЭ НИЯУ МИФИ)

</SMALL></DIV>

<P>
<BR>

<P>
<DIV ALIGN="CENTER">
<TABLE CELLPADDING=3>
<TR><TD ALIGN="RIGHT">Отделение</TD>
<TD ALIGN="LEFT">fcath[<BIG CLASS="LARGE">Интеллектуальные кибернетические системы] </BIG></TD>
</TR>
<TR><TD ALIGN="RIGHT">Направление подготовки</TD>
<TD ALIGN="LEFT">fcath[<BIG CLASS="LARGE">Информационные системы и технологии] </BIG></TD>
</TR>
</TABLE>
</DIV>

<P>

<P>

<P>

<DIV ALIGN="CENTER"><BIG CLASS="LARGE">Научно-исследовательская работа 
<BR></BIG></DIV>
<P>
<DIV ALIGN="CENTER"></DIV>
<P>
<BR>
<DIV ALIGN="CENTER"></DIV>
<P>
<DIV ALIGN="CENTER"><BIG CLASS="LARGE"><SPAN  CLASS="textbf"><BIG CLASS="XLARGE">		Разработка наземной системы позиционирования и навигации микродрона с применением компьютерного зрения
	</BIG></SPAN>
</BIG></DIV>
<P>
<DIV ALIGN="CENTER"></DIV>
<P>
<BIG CLASS="LARGE">
<BR>
<BR>
<BR>
</BIG>
<P>
<TABLE CELLPADDING=3 WIDTH="100%">
<TR><TD ALIGN="LEFT"><BIG CLASS="LARGE">
Студент группы ИС-Б17 </BIG></TD>
<TD ALIGN="CENTER"><BIG CLASS="LARGE"> xtitlesign </BIG></TD>
<TD ALIGN="RIGHT"><BIG CLASS="LARGE"> В. Ю. Петренко</BIG></TD>
</TR>
<TR><TD ALIGN="LEFT"><BIG CLASS="LARGE"> 
</BIG></TD>
<TD ALIGN="CENTER"><BIG CLASS="LARGE"> </BIG></TD>
<TD ALIGN="RIGHT"><BIG CLASS="LARGE"> </BIG></TD>
</TR>
<TR><TD ALIGN="LEFT"><BIG CLASS="LARGE"> 
Руководитель </BIG></TD>
<TD ALIGN="CENTER"><BIG CLASS="LARGE"> </BIG></TD>
<TD ALIGN="RIGHT"><BIG CLASS="LARGE"> </BIG></TD>
</TR>
<TR><TD ALIGN="LEFT"><BIG CLASS="LARGE"> 
к.т.н., доцент каф. ИС </BIG></TD>
<TD ALIGN="CENTER"><BIG CLASS="LARGE"> xtitlesign </BIG></TD>
<TD ALIGN="RIGHT"><BIG CLASS="LARGE"> О. А. Мирзеабасов</BIG></TD>
</TR>
<TR><TD ALIGN="LEFT"><BIG CLASS="LARGE"> 
</BIG></TD>
<TD ALIGN="CENTER"><BIG CLASS="LARGE"> </BIG></TD>
<TD ALIGN="RIGHT"><BIG CLASS="LARGE"> </BIG></TD>
</TR>
<TR><TD ALIGN="LEFT"><BIG CLASS="LARGE"> 
Научный консультант </BIG></TD>
<TD ALIGN="CENTER"><BIG CLASS="LARGE"> </BIG></TD>
<TD ALIGN="RIGHT"><BIG CLASS="LARGE"> </BIG></TD>
</TR>
<TR><TD ALIGN="LEFT"><BIG CLASS="LARGE"> 
Инженер ЦОНД </BIG></TD>
<TD ALIGN="CENTER"><BIG CLASS="LARGE"> xtitlesign </BIG></TD>
<TD ALIGN="RIGHT"><BIG CLASS="LARGE"> М. И. Турицын</BIG></TD>
</TR>
<TR><TD ALIGN="LEFT"><BIG CLASS="LARGE"> 
</BIG></TD>
<TD ALIGN="CENTER"><BIG CLASS="LARGE"> </BIG></TD>
<TD ALIGN="RIGHT"><BIG CLASS="LARGE"> </BIG></TD>
</TR>
</TABLE>
<P>
<BIG CLASS="LARGE">
</BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<DIV ALIGN="CENTER"><BIG CLASS="LARGE"><BIG CLASS="LARGE">Обнинск, 2020 г
</BIG></BIG></DIV><BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H1><A NAME="SECTION00010000000000000000">
<DIV ALIGN="CENTER">

</DIV>РЕФЕРАТ</A>
</H1><BIG CLASS="LARGE"><BIG CLASS="LARGE">
page стр., table табл., figure рис. , ист. 
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">БПЛА, КВАДРОКОПТЕР, КОМПЬЮТЕРНОЕ ЗРЕНИЕ, АВТОНОМНЫЙ ПОЛЕТ, НАЗЕМНАЯ СТАНЦИЯ
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Работа посвящена разработке программно-аппаратного комплекса, состоящего из наземной станции и управляемого ей квадрокоптера. Наземная станция представляет собой совокупность радиомодулей и микрокомпьютера Raspberry Pi. Суть данной НИР заключается в разработке архитектур наземной станции и квадрокоптера, изучении их протокола общения, а также создании экспериментального образца.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Разработанный ПАК дает возможность реализовать автономную навигацию и позиционирование квадрокоптера, выполняя команды наземной станции.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H1><A NAME="SECTION00020000000000000000">
<DIV ALIGN="CENTER">

</DIV>ОПРЕДЕЛЕНИЯ</A>
</H1><BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Квадрокоптер &#8212; БПЛА мультироторного типа с четырьмя несущими винтами
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H1><A NAME="SECTION00030000000000000000">
<DIV ALIGN="CENTER">

</DIV>ОБОЗНАЧЕНИЯ И СОКРАЩЕНИЯ</A>
</H1><BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">НИР &#8212; Научно-исследовательская работа
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">БПЛА &#8212; Беспилотный летательный аппарат
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">ПАК &#8212; Программно-аппаратный комплекс
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">MAVLink &#8211; Micro Air Vehicle Link
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">FPV &#8211; First Person View
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">ВМГ &#8211; Винто-моторная группа
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">HIL &#8211; hardware in the loop, или программно-аппаратное моделирование, ПАМ
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<BR>

<H2><A NAME="SECTION00040000000000000000">
<DIV CLASS="centerline" ID="par2835" ALIGN="CENTER">
СОДЕРЖАНИЕ</DIV>
</A>
</H2>
<!--Table of Contents-->

<UL CLASS="TofC">
<LI><A NAME="tex2html59"
  HREF="NIR_Petrenko.html#SECTION00040000000000000000">СОДЕРЖАНИЕ
</A>
<LI><A NAME="tex2html60"
  HREF="NIR_Petrenko.html#SECTION00060000000000000000">Предметная область</A>
<UL>
<LI><A NAME="tex2html61"
  HREF="NIR_Petrenko.html#SECTION00061000000000000000">Математическая модель квадрокоптера</A>
<LI><A NAME="tex2html62"
  HREF="NIR_Petrenko.html#SECTION00062000000000000000">Физическая модель квадрокоптера</A>
<LI><A NAME="tex2html63"
  HREF="NIR_Petrenko.html#SECTION00063000000000000000">Семейства прошивок полетного контроллера</A>
<LI><A NAME="tex2html64"
  HREF="NIR_Petrenko.html#SECTION00064000000000000000">PX4</A>
<LI><A NAME="tex2html65"
  HREF="NIR_Petrenko.html#SECTION00065000000000000000">MAVLink</A>
<LI><A NAME="tex2html66"
  HREF="NIR_Petrenko.html#SECTION00066000000000000000">ROS</A>
<LI><A NAME="tex2html67"
  HREF="NIR_Petrenko.html#SECTION00067000000000000000">MAVROS</A>
</UL>
<BR>
<LI><A NAME="tex2html68"
  HREF="NIR_Petrenko.html#SECTION00070000000000000000">Разработка архитектуры микродрона</A>
<UL>
<LI><A NAME="tex2html69"
  HREF="NIR_Petrenko.html#SECTION00071000000000000000">Аппаратная часть</A>
<LI><A NAME="tex2html70"
  HREF="NIR_Petrenko.html#SECTION00072000000000000000">Программная часть</A>
</UL>
<BR>
<LI><A NAME="tex2html71"
  HREF="NIR_Petrenko.html#SECTION00080000000000000000">Разработка архитектуры наземной станции</A>
<LI><A NAME="tex2html72"
  HREF="NIR_Petrenko.html#SECTION00090000000000000000">Протоколы общения дрона и наземной станции</A>
<UL>
<LI><A NAME="tex2html73"
  HREF="NIR_Petrenko.html#SECTION00091000000000000000">Структура пакета</A>
<LI><A NAME="tex2html74"
  HREF="NIR_Petrenko.html#SECTION00092000000000000000">Публикация</A>
<LI><A NAME="tex2html75"
  HREF="NIR_Petrenko.html#SECTION00093000000000000000">Многоадресные потоки и гарантированная доставка</A>
<LI><A NAME="tex2html76"
  HREF="NIR_Petrenko.html#SECTION00094000000000000000">Режим топиков (публикация-подписка)</A>
<LI><A NAME="tex2html77"
  HREF="NIR_Petrenko.html#SECTION00095000000000000000">Соединение точка-точка</A>
<LI><A NAME="tex2html78"
  HREF="NIR_Petrenko.html#SECTION00096000000000000000">Проверки целостности</A>
</UL>
<BR>
<LI><A NAME="tex2html79"
  HREF="NIR_Petrenko.html#SECTION000100000000000000000">Создание экспериментального образца</A>
<UL>
<LI><A NAME="tex2html80"
  HREF="NIR_Petrenko.html#SECTION000101000000000000000">Сборка квадрокоптера</A>
<LI><A NAME="tex2html81"
  HREF="NIR_Petrenko.html#SECTION000102000000000000000">Сборка наземной станции</A>
<LI><A NAME="tex2html82"
  HREF="NIR_Petrenko.html#SECTION000103000000000000000">Обновление и настройка параметров прошивки</A>
<LI><A NAME="tex2html83"
  HREF="NIR_Petrenko.html#SECTION000104000000000000000">Проверка работы экспериментального образца</A>
</UL></UL>
<!--End of Table of Contents--></BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H1><A NAME="SECTION00050000000000000000">
<DIV ALIGN="CENTER">

</DIV>ВВЕДЕНИЕ</A>
</H1><BIG CLASS="LARGE"><BIG CLASS="LARGE">

В современном мире технологии не стоят на месте, процессы постепенно автоматизируются, техника уменьшается в размерах, а способы управления машинами упрощаются. В программу основного общего образования включают курсы программирования и робототехники, закупаются образовательные комплекты.<A NAME="tex2html1"
  HREF="#foot249"><SUP><SPAN CLASS="arabic">1</SPAN></SUP></A>На рынке труда появляется спрос на специалистов в области БПЛА. БПЛА &#8211; беспилотные летательные аппараты, используемые для мониторинга, перевозки грузов, образовательных проектов. В 2020 году существует счетное количество решений, способных удовлетворить спрос образовательных учреждений для обучения программированию, сборке и управлению беспилотниками. Но у всех имеются недостатки, такие как высокая стоимость, травмоопасность, малые вычислительные мощности. В связи с этим появилась идея создания такого комплекта, удовлетворяющего большинству требований и исключающего вышеперечисленные недостатки. Идея состоит в том, чтобы вынести за борт квадрокоптера вычислительную технику, тем самым уменьшив размеры дрона и возможные риски.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Таким образом, получается программно &#8211; аппаратный комплекс из миниквадрокоптера и наземной управляющей станции. В данной научно &#8211; исследовательской работе будет рассмотрена аппаратная часть такого комплекта, а также описаны протоколы взаимодействия наземной станции с квадрокоптером.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H1><A NAME="SECTION00060000000000000000">
Предметная область</A>
</H1><BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE"><TT><A NAME="tex2html2"
  HREF="https://www.genebm.com/drone-bytes/software-design/middlewares-ros-fprime">https://www.genebm.com/drone-bytes/software-design/middlewares-ros-fprime</A></TT> часть обоснования выбора рос
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00061000000000000000">
Математическая модель квадрокоптера</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
Для понимания работы квадрокоптера рассмотрим его математическую модель в двух системах координат(СК):
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">1. Неподвижна система координат (НСК), в качестве которой выступает нормальная земная система координат с заданными перпендикулярными друг другу координатными осями <!-- MATH
 $O_{g}X_{g}$
 -->
<SPAN CLASS="MATH">1#1</SPAN>, <!-- MATH
 $O_{g}Y_{g}$
 -->
<SPAN CLASS="MATH">2#2</SPAN>, и <!-- MATH
 $O_{g}Z_{g}$
 -->
<SPAN CLASS="MATH">3#3</SPAN>, причем ось <!-- MATH
 $O_{g}Z_{g}$
 -->
<SPAN CLASS="MATH">3#3</SPAN> направлена противоположно вектору силы тяжести.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">2. Связанная с квадрокоптером система координат (ССК), центр которой размещен в центре масс аппарата, а оси OX, OY, и OZ параллельны и сонаправлены с осями неподвижной системы. Угловое положение аппарата зададим тремя углами Эйлера: углами крена <SPAN CLASS="MATH">4#4</SPAN>, тангажа <SPAN CLASS="MATH">5#5</SPAN> и рыскания <SPAN CLASS="MATH">6#6</SPAN>, определяющими вращение вокруг осей OX, OY, и OZ соответственно. Основываясь на ранее рассмотренных системах координат можно утверждать о том, что квадрокоптер имеет шесть степеней свободы, а именно три линейных координаты [x; y; z ] и три угловых <!-- MATH
 $[\theta, \phi, \psi]$
 -->
<SPAN CLASS="MATH">7#7</SPAN>. В качестве управляющих каналов выступают скорости вращения роторов (рис. <A HREF="#fig:ris1">1</A>), которые создают динамику движения БПЛА в пространстве. Согласно (1–3), возникающие в результате подачи управляющих воздействий силы и моменты пропорциональны квадрату угловых скоростей винтов <SPAN CLASS="MATH">8#8</SPAN> . Поэтому, для достижения желаемого режима работы БПЛА, необходимо связать совокупность управляющих воздействий со степенями свободы БПЛА, через уравнения связи, которые определяют основные режимы движения квадрокоптера в пространстве.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:ris1"></A><A NAME="272"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 1.:</STRONG>
Связанная система координат квадрокоптера
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="436" HEIGHT="269" ALIGN="BOTTOM" BORDER="0"
 SRC="./ris1.png"
 ALT="Image ris1">
	
</TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">
В качестве первого режима БПЛА <SPAN CLASS="MATH">9#9</SPAN> рассмотрим движение вдоль оси OZ, принадлежащей ССК. Данное движение обеспечивается одновременным увеличением скоростей винтов на одинаковое значение угловой скорости <SPAN CLASS="MATH">10#10</SPAN>. Полученное при этом движение (рис.&nbsp;<A HREF="#fig:ris1">1</A>) характеризуется взлетом или посадкой квадрокоптера (при нулевых значениях тангажа и крена) и описывается следующим выражением:
</BIG></BIG><P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
U_{1}=b(\Omega_{1}^2+\Omega_{2}^2+\Omega_{3}^2+\Omega_{4}^2)
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH">11#11</SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">1</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P><BIG CLASS="LARGE"><BIG CLASS="LARGE">
где b – аэродинамическая составляющая тяги винта.
В качестве второго режима движения БПЛА <SPAN CLASS="MATH">12#12</SPAN> необходимо взять поворот вокруг оси OX, принадлежащей ССК. Данное движение достигается путем увеличения/уменьшения на величину <SPAN CLASS="MATH">10#10</SPAN> значения <!-- MATH
 $\Omega_{4}$
 -->
<SPAN CLASS="MATH">13#13</SPAN> левого винта и уменьшением/увеличением на величину <SPAN CLASS="MATH">14#14</SPAN> значения <!-- MATH
 $\Omega_{1}$
 -->
<SPAN CLASS="MATH">15#15</SPAN>
правого. Полученное при этом движение характеризуется изменением угла крена <SPAN CLASS="MATH">4#4</SPAN> (рис.&nbsp;<A HREF="#fig:ris2">2</A>) и описывается следующим выражением:
</BIG></BIG><P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
U_{2}=lb(-\Omega_{2}^2-\Omega_{4}^2)
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH">16#16</SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">2</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P><BIG CLASS="LARGE"><BIG CLASS="LARGE">
где l – расстояние между центром квадрокоптера и центром винта.
</BIG></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:ris2"></A><A NAME="295"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 2.:</STRONG>
Вращение квадрокоптера вокруг оси OX
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="341" HEIGHT="227" ALIGN="BOTTOM" BORDER="0"
 SRC="./ris2.png"
 ALT="Image ris2">
	
</TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">
В качестве третьего режима движения <SPAN CLASS="MATH">17#17</SPAN> необходимо взять поворот БПЛА вокруг оси OY , принадлежащей ССК. Данное движение достигается путем уменьшения/увеличения на величину <SPAN CLASS="MATH">10#10</SPAN> значения <!-- MATH
 $\Omega_{1}$
 -->
<SPAN CLASS="MATH">15#15</SPAN> фронтального винта и увеличения/уменьшения на величину <SPAN CLASS="MATH">14#14</SPAN> значения <!-- MATH
 $\Omega_{3}$
 -->
<SPAN CLASS="MATH">18#18</SPAN> заднего. Полученное при этом движение характеризуется изменением угла тангажа <SPAN CLASS="MATH">5#5</SPAN> (рис.&nbsp;<A HREF="#fig:ris3">3</A>) и описывается следующим выражением:
</BIG></BIG><P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
U_{3}=lb(-\Omega_{1}^2-\Omega_{3}^2)
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH">19#19</SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">3</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P><BIG CLASS="LARGE"></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:ris3"></A><A NAME="309"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 3.:</STRONG>
Вращение вокруг оси OY
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="234" HEIGHT="158" ALIGN="BOTTOM" BORDER="0"
 SRC="./ris3.png"
 ALT="Image ris3">
	
</TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:ris4"></A><A NAME="314"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 4.:</STRONG>
Вращение вокруг оси OZ
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="223" HEIGHT="152" ALIGN="BOTTOM" BORDER="0"
 SRC="./ris4.png"
 ALT="Image ris4">
	
</TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">В качестве последнего, четвертого, режима движения <SPAN CLASS="MATH">20#20</SPAN> необходимо взять поворот БПЛА вокруг оси OZ , принадлежащей ССК. Данное движение достигается путем одновременного увеличения/уменьшения на величину <SPAN CLASS="MATH">10#10</SPAN> значений <!-- MATH
 $\Omega_{4}$
 -->
<SPAN CLASS="MATH">13#13</SPAN> левого и <!-- MATH
 $\Omega_{2}$
 -->
<SPAN CLASS="MATH">21#21</SPAN> правого винтов, а также одновременного уменьшения/увеличения на величину <SPAN CLASS="MATH">14#14</SPAN> значений <!-- MATH
 $\Omega_{1}$
 -->
<SPAN CLASS="MATH">15#15</SPAN> фронтального и <!-- MATH
 $\Omega_{3}$
 -->
<SPAN CLASS="MATH">18#18</SPAN> заднего винтов. Благодаря вращению роторов в диагонально противоположных направлениях, полученное движение характеризуется изменением угла рыскания <SPAN CLASS="MATH">22#22</SPAN> (рис.&nbsp;<A HREF="#fig:ris4">4</A>) и описывается следующим выражением:
</BIG></BIG><P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
U_{4}=d(-\Omega_{1}^2+\Omega_{2}^2-\Omega_{3}^2+\Omega_{4}^2)
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH">23#23</SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">4</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P><BIG CLASS="LARGE"><BIG CLASS="LARGE">
где d – аэродинамическая составляющая коэффициента сопротивления среды.
Введенное, с учетом (1) – (4), множество U, характеризующее режимы
движения квадрокоптера можно записать следующим образом:
<BR>
24#24
<BR>
Множество U определяет связь между системой исполнительных приводов и платформой БПЛА. Поэтому, при дальнейшем рассмотрении математической модели динамики движения квадрокоптера, режимы движения (1) – (4) будут использоваться как задающие воздействия для платформы БПЛА. [#!mathmodel!#]
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00062000000000000000">
Физическая модель квадрокоптера</A>
</H2><BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Квадрокоптер &#8211; беспилотный летательный аппарат мультироторного типа с четырмя несущими винтами.
Квадрокоптер состоит из:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; рамы,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; 4 моторов,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; 4 регуляторов оборотов,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; полетного контроллера,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; камеры,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; видеопередатчика,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; видеоантенны,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; радиоприемника,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; другой периферии (например, gps, магнитометра, дальномера, телеметрийного модуля)
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:pix"></A><A NAME="353"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 5.:</STRONG>
Пример схемы подключения
 	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV> 	<IMG
  WIDTH="963" HEIGHT="542" ALIGN="BOTTOM" BORDER="0"
 SRC="./pix.jpg"
 ALT="Image pix"></TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">
Рама - несущий компонент, на котором располагается вся электроника квадрокоптера. В большинстве случаев представляет собой крестообразную конструкцию. Рама должна быть жесткой, чтобы не создавать осцилляции для ПИД регулятора, и в то же время легкой. На данный момент лучшим материалом для рам квадрокоптеров является карбон.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Для современных БПЛА используются бесколлекторные моторы. Основными их характеристиками являются размер и количество оборотов на вольт. В зависимости от перечисленных характеристик, веса летательного аппарата, выбранного аккумулятора, поставленных задач подбираются пропеллеры.
Диаметр пропеллера и количество лопастей определяют статическую тягу квадрокоптера. Шаг пропеллера определяет скорость потока воздуха.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Регулятор оборотов передает энергию от батареи к двигателю, преобразуя постоянный ток источника питания в переменный ток, который нужен мотору. Количество оборотов мотора определяет полетный контроллер.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Для питания квадрокоптера используются литий-полимерные и литий-ионные аккумуляторы. В зависимости от задач и размеров подбирается количество ячеек аккумулятора, емкость и токоотдача.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Полетный контроллер &#8211; система реального времени, которая интерпретирует входящие данные от приемника и бортовых датчиков (гироскопа, акселерометра, барометра), на основе которых рассчитывает и передает ШИМ на регуляторы оборотов, и тем самым производится регулировка скорости моторов. Все алгоритмы работы полетного контроллера содержатся в прошивке &#8211; программном обеспечении, которое выбирается в зависимости от схемы полетного контроллера и поставленных задач.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Видеосистема состоит из трех основных компонентов: камера, видеопередатчик и передающая антенна. Видеопередатчик, в большинстве случаев, на частоте 5.8ГГц и указанной мощности передает изображение с камеры.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Для осуществления управления квадрокоптером используются радиопередатчики. Для приема сигнала к полетному контроллеру подключается приемник, общающийся с передатчиком по определенному протоколу на указанном диапазоне частот. В случае, если необходима обработка видеопотока или сбор информации, на квадрокоптер также ставится бортовой компьютер, так как обладает большими вычислительными мощностями. Как правило, бортовой компьютер представляет собой микрокомпьютер по типу raspberry pi или nvidia jetson. Информация с датчиков квадрокоптера оператору может передаваться с помощью телеметрийных модулей.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Теперь разберем, какие есть прошивки для полетных контроллеров.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00063000000000000000">
Семейства прошивок полетного контроллера</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
Закрытые платные прошивки не интересуют, так как их невозможно модифицировать под наши нужды. Если взять во внимание наиболее популярные открытые прошивки для полетных контроллеров, то можно выделить 2 семейства: потомки MultiWii и прошивки под полетные контроллеры семейства PixHawk.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">MultiWii - прошивка, изначально разработанная для получения и обработки данных с гироскопов и акселерометров игровой консоли Nintendo Wii. Позже был спроектирован полетный контроллер, куда был прошит MultiWii. Со временем MultiWii перерос в BaseFlight, а он в свою очередь в CleanFlight. Разработчики CleanFlight разошлись во мнениях касаемо функционала прошивки и сделали следующие ответвления:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212;BetaFlight,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212;INav,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212;EmuFlight
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">BetaFlight нацелен на гоночные квадрокоптеры. Основными особенностями являются: минимальная фазовая задержка, точное следование управляющему сигналу и поддержка огромного количества полетных контроллеров.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">INav сфокусирован на навигационных возможностях. Позволяет выполнять полеты по точкам, исходя из данных, полученных периферией. Поддерживает различные платформы, включая БПЛА мультироторного и самолетного типов, сухопутные и водные управляемые модели.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">EmuFlight предназначен для полетов в свободном стиле. Позволяет настроить квадрокоптер на плавный полет, содержит множество алгоритмов для фильтрации шумов.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Для семейства PixHawk наиболее популярны PX4 и Ardupilot. Эти прошивки активно используются как хоббистами, так и специалистами в промышленной сфере. Они имеют множество проверенных временем функций, позволяющих выполнять автономные миссии. Ardupilot, в основном, разрабатывается и используется хоббийным сообществом. В то время как основным разработчиком PX4 является группа AeroAstro из MIT.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Изначально это был научный проект, но сейчас его используют исследователи в области программирования, стабилизации и навигации БПЛА во всем мире. Главными особенностями PX4 являются поддержка огромного количества датчиков и навигация в режиме OFFBOARD, который позволяет управлять беспилотником при помощи бортового компьютера. Именно этот режим нам и нужен, чтобы наземная станция управляла квадрокоптером. Рассмотрим PX4 подробнее.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00064000000000000000">
PX4</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
<TT><A NAME="tex2html8"
  HREF="https://docs.px4.io/master/en/getting_started/px4_basic_concepts.html">https://docs.px4.io/master/en/getting_started/px4_basic_concepts.html</A></TT></BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE"><TT><A NAME="tex2html9"
  HREF="https://docs.px4.io/master/en/contribute/licenses.html">https://docs.px4.io/master/en/contribute/licenses.html</A></TT></BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">PX4 - прошивка с открытым исходным кодом, публикуемая под лицензией BSD. PX4 позволяет управлять различными типами беспилотников, включая: летательные (мультикоптеры, самолеты и вертолеты), наземные и подводные аппараты. Он совместим с большим количеством оборудования, датчиков и другой периферии. Позволяет реализовать гибкие режимы полета и функции безопасности.
Параметры PX4 настраиваются с помощью QGroundControl.[#!px4!#]
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">QGroundControl - кросплатформенный конфигуратор для настройки PX4 и Ardupilot прошивок. Он обеспечивает полное управление полетом и настройку беспилотника. [#!qgroundcontrol!#]
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">PX4 для определения состояния аппарата, его стабилизации и автономного полета использует датчики, такие как: гироскоп, акселерометр, магнитометр (компас) и барометр. Для включения всех автоматических режимов и некоторых вспомогательных требуется GPS или другая система позиционирования.
Для передачи данных / телеметрии между наземной станцией управления, такой как QGroundControl, и беспилотником, работающим под управлением PX4 может использоваться как проводное, так и беспроводное соединение по протоколу MAVLink. Он позволяет настраивать параметры во время полета, проверять телеметрию в режиме реального времени, менять миссию на лету и т. д.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">PX4 можно управлять с отдельного компьютера-компаньона через последовательный кабель или Wi-Fi. Компаньон-компаньон обычно обмениваются данными с помощью API MAVLink, такого как MAVSDK или MAVROS.
[#!px4!#]
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00065000000000000000">
MAVLink</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
<TT><A NAME="tex2html10"
  HREF="https://mavlink.io/en/">https://mavlink.io/en/</A></TT></BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">MAVLink &#8211; это очень легкий протокол обмена сообщениями для связи с дронами (и между бортовыми компонентами дронов).
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">MAVLink следует современному гибридному шаблону проектирования «публикация-подписка» и «точка-точка»: потоки данных отправляются / публикуются как темы, а подпротоколы конфигурации, такие как протокол задания или протокол параметров, являются point-to-point с повторной передачей.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Сообщения определяются в файлах XML. Каждый файл XML определяет набор сообщений, поддерживаемый MAVLink системой, также называемый «диалектом». Набор эталонных сообщений, который реализуется большинством наземных станций управления и автопилотов, определен в common.xml (большинство диалектов основано на этом определении).
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Набор инструментов MAVLink использует определения XML сообщений для генерации библиотеки MAVLink для каждого из поддерживаемых языков программирования . Дроны, наземные станции управления и другие системы MAVLink используют сгенерированные библиотеки для связи. Они распространяются под лицензией MIT и поэтому могут использоваться без ограничений в любом приложении с закрытым исходным кодом без публикации исходного кода. MAVLink был впервые выпущен в начале 2009 года Лоренцем Мейером (основателем PX4) и в настоящее время имеет значительное количество разработчиков.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">MAVLink поддерживает множество языков программирования, работающих на множестве микроконтроллеров / операционных систем (включая ARM7, ATMega, dsPic, STM32 и Windows, Linux, MacOS, Android и iOS). Допускает одновременно до 255 систем в сети (беспилотники, наземные станции и т. д.)
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Обеспечивает как внешнюю, так и бортовую связь (например, между groundcontrol и дроном, а также между автопилотом дрона и камерой дрона с поддержкой MAVLink).
[#!mavlink!#]
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">MAVLink развернут в двух основных версиях: v1.0 и v2.0, которые имеют обратную совместимость (реализации v2.0 могут анализировать и отправлять пакеты v1.0). Потоки телеметрических данных отправляются в многоадресном режиме, в то время как аспекты протокола, которые изменяют конфигурацию системы и требуют гарантированной доставки, являются point-to-point с повторной передачей.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">//переделать
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Для того, чтобы наземная станция могла общаться по MAVLink с БПЛА, необходима операционная система. Разработка ОС &#8211; задача трудоемкая и не всегда обоснованная, так как существует множество готовых решений. ОС на базе ядра Linux имеют набор инструментов, позволяющий  Одним из них является ROS.
</BIG></BIG>
<H2><A NAME="SECTION00066000000000000000">
ROS</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
<TT><A NAME="tex2html11"
  HREF="https://www.ros.org/about-ros/">https://www.ros.org/about-ros/</A></TT></BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Robotic Operation System (ROS) - это гибкая платформа для написания программного обеспечения для роботов; набор инструментов, библиотек и соглашений, которые призваны упростить задачу создания сложного и надежного поведения роботов на самых разных роботизированных платформах.
[#!ros!#]
Целью создания ROS является создание среды разработки, которая позволяет разработчикам ПО для роботов взаимодействовать на глобальном уровне.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">ROS сосредоточена на максимизации повторного использования кода при разработке. Основные характеристики, позволяющие это реализовать:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Распределенный процессы. Структура ROS создана в виде минимальных единиц исполняемых процессов (нод), и каждый процесс выполняется изолированно. Взаимодействие разных нод происходит только на уровне обмена сообщениями.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Управление пакетами. Несколько процессов, имеющих общую задачу, объединяются в пакеты. Управление пакетами подразумевает набор утилит, позволяющих автоматически скачивать, устанавливать и удалять пакеты. Пакетный менеджер гарантирует работоспособность и целостность установленных пакетов.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Публичные репозитории и документация. Каждый доступный пакет публикуется в публичном репозитории. Документация пакетов публикуется в единой системе, которая упрощает поиск необходимых пакетов.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Единое API. При разработке программы, использующей ROS, вы получаете простое и легко встраиваемое API. При этом при использовании API нет разницы, на каком языке была написана программа.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Поддержка различных языков программирования. ROS предоставляет клиентские библиотеки для поддержки различных языков программирования. Наиболее популярны Python, C ++, а также такие языки, как Lisp, JAVA, C#, Lua и Ruby.
[#!voltbro!#]
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Концепции
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Ноды
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Основная статья: <TT><A NAME="tex2html12"
  HREF="http://wiki.ros.org/Nodes">http://wiki.ros.org/Nodes</A></TT></BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">ROS-нода – это специальная программа (обычно написанная на Python или C++), которая взаимодействует с другими нодами посредством ROS-топиков и ROS-сервисов. Разделение сложных робототехнических систем на изолированные ноды дает определенные преимущества: понижается связанность кода, повышается переиспользуемость и надежность.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Очень многие робототехнические библиотеки и драйвера выполнены именно в виде ROS-нод.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Для того, чтобы превратить обычную программу в ROS-ноду, необходимо подключить к ней библиотеку rospy или roscpp и добавить инициализирующий код.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Пример ROS-ноды на языке Python:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">
<BR>
<A NAME="lst:1"></A>25#25
<BR>
Топики
Основная статья: http://wiki.ros.org/Topics
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Топик – это именованная шина данных, по которой ноды обмениваются сообщениями. Любая нода может опубликовать сообщение в произвольный топик, а также подписаться на произвольный топик.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">
<BR>
<A NAME="lst:1"></A>26#26
<BR>
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Также, существует возможность работы с топиками с помощью утилиты rostopic. Например, с помощью следующей команды можно просматривать сообщения, публикуемые в топик /mavros/state:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">rostopic echo /mavros/state
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Сервисы
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Основная статья: <TT><A NAME="tex2html13"
  HREF="http://wiki.ros.org/Services">http://wiki.ros.org/Services</A></TT></BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Сервис – это некоторый аналог функции, которая может быть вызвана из одной ноды, а обработана в другой. У сервиса есть имя, аналогичное имени топика, и 2 типа сообщений: тип запроса и тип ответа.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">
<BR>
<A NAME="lst:1"></A>27#27
<BR>
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00067000000000000000">
MAVROS</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
<TT><A NAME="tex2html14"
  HREF="https://clover.coex.tech/ru/mavros.html">https://clover.coex.tech/ru/mavros.html</A><A NAME="tex2html15"
  HREF="https://dev.px4.io/master/en/ros/mavros_installation.html">https://dev.px4.io/master/en/ros/mavros_installation.html</A></TT></BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">MAVROS (MAVLink + ROS) — это пакет для ROS, предоставляющий возможность управлять беспилотниками по протоколу MAVLink. MAVROS поддерживает полетные стеки PX4 и APM. Связь организовывается по UART, USB, TCP или UDP.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">MAVROS подписывается на определенные ROS-топики в ожидании команд, публикует в другие топики телеметрию, и предоставляет сервисы.
Пакет mavros ROS обеспечивает расширяемую связь MAVLink между компьютерами, на которых работает ROS, автопилоты с поддержкой MAVLink и GCS с поддержкой MAVLink.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">MAVROS - это «официальный» поддерживаемый мост между ROS и протоколом MAVLink. В настоящее время он расширяется, чтобы включить обмен сообщениями fast-RTPS , включая уровень для преобразования сообщений uORB PX4 в общие идиомы ROS.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Хотя MAVROS может использоваться для связи с любым автопилотом с поддержкой MAVLink, эта документация будет в контексте обеспечения связи между полетным стеком PX4 и компаньоном с поддержкой ROS.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H1><A NAME="SECTION00070000000000000000">
Разработка архитектуры микродрона</A>
</H1><BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00071000000000000000">
Аппаратная часть</A>
</H2><BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Набор наземной станции и квадрокоптера в основном планируется использовать в помещении. В случае использования БПЛА на улице, при весе свыше 250г требуется регистрация, согласно воздушному кодексу Российской Федерации[#!ivp!#] . Основываясь на этом, поставлены следующие условия к компонентам квадрокоптера:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; размер не должен превышать 140*140*50 <SPAN CLASS="MATH">28#28</SPAN>,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; полетный вес должен быть ниже 250 г,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; квадрокоптер должен выдерживать столкновения,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; пропеллеры должны быть защищены,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; минимальное полетное время 5 мин,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; возможность обмениваться телеметрией
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Провела анализ рынка радиоуправляемых квадрокоптеров и заметила, что готовых вариантов, соответствующих вышеперечисленным условиям, нет. В связи с чем необходимо подобрать компоненты и собрать вручную.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Подходя к вопросу выбора рамы, стоит учитывать такие факторы как:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; прочность рамы,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; легкий вес,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; диагональную жесткость,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; стоимость,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; расстояния между отверстиями, совпадающие с монтажными отверстиями на электронике
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Были проведены испытания с рамами из разных материалов. Рассматривались следующие альтернативы: фанера, PLA и PETG пластики, текстолит, карбон. Фанера обладает низкой стоимостью, но уступает по жесткости остальным альтернативам. PLA пластик самый безопасный для здоровья человека, им можно печатать детали на 3d принтере, но не устойчив к ударам. PETG обладает большей прочностью по сравнению с ПЛА, но недостаточно жесткий, в связи с чем увеличивается собственная частота колебаний. Чем больше собственная частота колебаний, тем больше фильтрации требуется, чтобы не вносить в гироскоп осцилляции, которые ухудшают работу ПИД регулятора полетного контроллера. Текстолит является самым жестким среди вышеперечисленных альтернатив, но обладает самым большим весом. Карбон уступает по стоимости, однако является самым прочным, жестким и относительно легким вариантом. Таким образом, было решено использовать карбоновую раму.
Защита для пропеллеров пластиковая, так как обладает упругостью и низкой стоимостью.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Форм фактор рамы также является немаловажной деталью. Для выполнения задач позиционирования и навигации в зависимости от условий необходимо будет поворачивать камеру вниз, вперед и вверх. Исходя из этого, необходимо, чтобы защита пропеллеров, пластины рамы, а также аккумулятор не перекрывали обзор/уменьшали область видимости. Оптимальным решением является рама с вытянутым корпусом и расположением лучей по типу deadcat – передние лучи разведены на угол, близкий к 180 градусам. Расстояние между отверстиями для монтажа электроники выгоднее выбирать из стандартов - 16*16, 20*20 или 25,5*25,5 мм. Вариант 25,5*25,5мм рассматривать стоит только в том случае, если необходимо использовать “все в одном”: плату, состоящую из полетного контроллера и регулятора одновременно. В этой работе такая плата неуместна, так как: в случае поломки заменяется полностью, стоимость больше, чем у регуляторов и полетного контроллера вместе, и выбор такого формата плат, с ресурсами, необходимыми для реализации моего проекта, крайне мал. Основываясь на вышеперечисленном была приобретена рама, представленная на рисунке <A HREF="#fig:frame">6</A>. Она позволяет установить нано камеру (размером 14*14 мм), стеки из полетного контроллера и регуляторов с посадочными отверстиями 20x20mm/16x16mm, моторы размера 1102-1308 и пропеллеры диаметром 40 мм.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:frame"></A><A NAME="692"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 6.:</STRONG>
Рама для экспериментального образца квадрокоптера
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="1000" HEIGHT="1000" ALIGN="BOTTOM" BORDER="0"
 SRC="./frame.jpg"
 ALT="Image frame">
	
</TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Электроника квадрокоптера должна быть совместимой по характеристикам и габаритам. 
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Для управления с наземной станции полетный контроллер должен:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; обладать минимум 3 UART портами,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; иметь процессор на базе F405 / F745 / F765 чипа
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">UART (Universal asynchronous receiver/transmitter) &#8211; это аппаратный последовательный интерфейс, который позволяет подключать датчики и периферию к полетному контроллеру. У него есть два вывода для внешнего соединения: TX &#8211; для передачи данных, RX &#8211; для приема.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Выбор чипа процессора основан на количестве ресурсов. Для того, чтобы прошить PX4, необходим объем памяти процессора не ниже 1 МБ. Такое условие выполняют процессоры на базе F405/F745/F765.
Винто-моторная группа должна быть оптимизирована под задачи автономного полета в помещении на небольшой скорости и вмещаться в выбранную раму. У бесколлекторных моторов основными параметрами являются размеры статора, неподвижной части мотора, (4 цифры) и количество оборотов на вольт(kv). В четырех-значном числе первые два отвечают за диаметр статора , вторые &#8211; за высоту статора. При одинаковых объемах статора крутящий момент на низких оборотах будет больше у того мотора, где больше диаметр статора, а на высоких оборотах там, где больше высота. Для экспериментально образца оптимальным выбором являются моторы 1202. Количество оборотов на вольт выберем, учитывая напряжение аккумулятора. Чем больше напряжение, тем меньше количество оборотов на вольт должно быть на моторе. Каждая ячейка, подключенная последовательно увеличивает напряжение на 4.2 В в заряженном состоянии. Для квадрокоптера с диагональю рамы 120 мм по соотношению вес / токоотдача наиболее выгодно ставить аккумуляторы с 2-3 ячейками. Основываясь на таблице характеристик, приведенных производителем, были выбраны моторы с 6000 kv (рис. <A HREF="#fig:motor">7</A>).
Учитывая потребление тока моторами на полном газу и добавляя 15 % запаса, получаем характеристику регуляторов &#8211; максимальный ток, проходящий через них. На экспериментальном образце он равен 15 А.
</BIG></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:motor"></A><A NAME="698"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 7.:</STRONG>
Моторы для экспериментального образца квадрокоптера
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="900" HEIGHT="900" ALIGN="BOTTOM" BORDER="0"
 SRC="./motor.jpg"
 ALT="Image motor">
	
</TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:stack"></A><A NAME="703"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 8.:</STRONG>
Стек электроники для экспериментального образца квадрокоптера
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="1000" HEIGHT="1000" ALIGN="BOTTOM" BORDER="0"
 SRC="./stack.jpg"
 ALT="Image stack">
	
</TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">
Видеопередатчик и камера выбирались исходя из поставленных условий. Так как необходимо будет передавать видеопоток, камера должна иметь максимально возможное количество телевизионных линий &#8211; разрешаяющая способность (TVL). Для камер нано формата это 1000 TVL. Размер изображения может быть как 4:3 и 16:9. Формат PAL / NTSC также может быть выбран на усмотрение.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Видеопередатчик обладает такими характеристиками как:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; выходная мощность,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; выходная частота,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; количество каналов
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Для помещений мощность 25mW является оптимальной. Количество каналов должно быть выбрано таким образом, чтобы в случае совместных полетов сигнал не пересекался с сигналом другого беспилотника. Современные видеопередатчики имеют 40 каналов. Частота видеосигнала будет использоваться 5.8ГГц.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Для общения с наземной станцией понадобятся радиоприемник и телеметрийный модуль. Телеметрийный модуль &#8211; 
Протокол и частота модулей станции и квадрокоптера должны совпадать.</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00072000000000000000">
Программная часть</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
В качестве прошивки для квадрокоптера был выбран PX4 - проект с открытым исходным кодом, позволяющий выполнять автономные полеты.
//почему был выбран рх4?
//его возможности?
//estimator lpe / ekf
<TT><A NAME="tex2html19"
  HREF="https://dev.px4.io/v1.9.0/en/ros/offboard_control.html">https://dev.px4.io/v1.9.0/en/ros/offboard_control.html</A><A NAME="tex2html20"
  HREF="https://dev.px4.io/v1.9.0/en/ros/external_position_estimation.html">https://dev.px4.io/v1.9.0/en/ros/external_position_estimation.html</A></TT></BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H1><A NAME="SECTION00080000000000000000">
Разработка архитектуры наземной станции</A>
</H1><BIG CLASS="LARGE"><BIG CLASS="LARGE">
Аппаратная часть наземной станции состоит из:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; компьютера,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; передающего модуля радиоуправления,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; видеоприемника,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; устройства приема-передачи телеметрии
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">К компьютеру по UART порту подключается модуль радиоуправления. Через USB порт подключается видеоприемник. Устройство приема-передачи телеметрии также подключается к компьютеру по UART порту. Настраиваем видеоприемник на частоту, соответствующую частоте видеопередатчика квадрокоптера и приступаем к настройке программной части.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Программная часть представляет собой совокупность взаимодействущего программного обеспечения, включающего в себя:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; операционную систему на базе ядра linux,
&#8212; qgroundcontrol,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; web-браузер,
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; консоль
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">В qgroundcontrol выставляется бауд-рейт &#8211; скорость передачи данных для подключенного устройства приема-передачи телеметрии. 115200 &#8211; максимально доступный для используемого. Далее происходит подключение и обмен данными с устройством приема-передачи телеметрии, расположенного на борту квадрокоптера.
По MAVLink протоколу передаются данные в указанный UART, и все программы, прослушивающие этот UART порт имеют доступ к данным с борта квадрокоптера. Для взаимодействия через ROS инструменты необходима настройка всех параметров подключения. На данном этапе НИР используется готовой решение от Copter Express &#8211; пакет clover, позволяющий производить настройку максимально просто. В launch файлах пакета прописываются все параметры. Указываем UART, бауд-рейт, и в консоли запускаем clover с помощью команд:
<BR>
29#29
<BR>
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">После этого доступны все инструменты ROS. На листинге <A HREF="#lst:1">4</A> приведен результат выполнения команды для получения телеметрии. "frame_id: &rdquo;" означает, что показания берутся в системе координат относительно квадрокоптера.
<BR>
<A NAME="lst:1"></A>30#30
<BR>
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Видеоприемник подключен в устройствах как /dev/video0. Указываем его в launch-файле, перезагружаем clover и проверяем в web-браузере топики по адресу localhost:8080 (рис. <A HREF="#fig:topic">9</A>).
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:topic"></A><A NAME="804"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 9.:</STRONG>
Список топиков, доступный по умолчанию
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="536" HEIGHT="295" ALIGN="BOTTOM" BORDER="0"
 SRC="./topic.png"
 ALT="Image topic"></TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Список топиков также меняется в launch файлах. В image raw топике будет отображаться видеопоток, полученный видеоприемником с борта квадрокоптера, в остальных топиках публикуются:
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; aruco-detect (на image raw определяются с помощью openCV aruco маркеры),
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; optical flow (на изображение с image raw накладывается точка отсчета для лазерного дальномера),
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">&#8212; aruco map (карта маркеров, прописанная в конфигурационном файле).
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Aruco маркеры &#8211; маркеры, напоминающие QR коды, созданные для позиционирования робототехнических систем с использованием компьютерного зрения.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Aruco-detect &#8211; НОДа ROS для распознавания карты маркеров. На ее основе планируется реализация системы навигации и позиционирования квадрокоптера для наземной станции. 
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H1><A NAME="SECTION00090000000000000000">
Протоколы общения дрона и наземной станции</A>
</H1><BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00091000000000000000">
Структура пакета</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
Рассмотрим подробнее устройство MAVLink. Ниже приведена структура пакета MAVLink v2. Представление в памяти может отличаться.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t magic;              //Метка начала
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t len;                //Размер данных/длинна полезной нагрузки (сообщения)
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t incompat_flags;     //Обратно несовместимые флаги
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t compat_flags;       //Обратно совместимые флаги
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t seq;                //Порядковый номер сообщения для выявления потери сообщения
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t sysid;              //ID системы-отправителя
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t compid;             //ID компонента-отправителя
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t msgid 0:7;          //ID сообщения (первый байт), от него зависит, какие данные будут лежать в полезной нагрузке пакета
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t msgid 8:15;         //ID сообщения (второй байт)
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t msgid 16:23;        //ID сообщения (третий байт)
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t payload[max 255];   //Полезная нагрузка (размер сообщения максимум 255 байт) 
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint16_t checksum;          //Контрольная сумма
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">uint8_t signature[13];      //Сигнатура (опционально)
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Структура пакета MAVLink v1 аналогична, но опускает incompat_flags, compat_flags и signature, и имеет только один байт для адреса сообщения.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00092000000000000000">
Публикация</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
Беспроводной формат MAVLink оптимизирован для систем с ограниченными ресурсами и, следовательно, порядок полей не такой, как в спецификации XML. Беспроводной генератор сортирует все поля сообщения по размеру, сначала с самыми большими полями (uint64_t), а затем с меньшими полями. Сортировка выполняется с использованием стабильного алгоритма сортировки, который гарантирует, что любые поля, которые не нужно переупорядочивать, останутся в том же относительном порядке. Это предотвращает проблемы с выравниванием в системах кодирования / декодирования и позволяет очень эффективно упаковывать / распаковывать.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00093000000000000000">
Многоадресные потоки и гарантированная доставка</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
MAVLink создан для гибридных сетей, в которых высокоскоростные потоки данных от источников данных (беспилотных летательных аппаратов) поступают в приемники данных (наземные станции), но смешиваются с передачами, требующими гарантированной доставки. Ключевой вывод состоит в том, что для большинства потоков телеметрии не существует известного или единственного получателя: вместо этого, как правило, бортовой компьютер, наземная станция управления и облачная система нуждаются в одном и том же потоке данных.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">С другой стороны, настройка бортовой миссии или изменение конфигурации системы с бортовыми параметрами требует точка-точка связи с гарантированной доставкой. MAVLink достигает очень высокой эффективности за счет использования обоих режимов работы.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00094000000000000000">
Режим топиков (публикация-подписка)</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
В режиме топиков протокол не будет выдавать идентификатор целевой системы и компонента для сообщений, чтобы сэкономить пропускную способность канала. Типичными примерами этого режима связи являются все потоки данных автопилота, такие как положение, координаты и т. д.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Основное преимущество этого режима заключается в том, что не создаются дополнительные накладные расходы, и все подписчики могут получать эти данные.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00095000000000000000">
Соединение точка-точка</A>
</H2><BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">В режиме точка-точка MAVLink использует идентификатор цели и целевой компонент. В большинстве случаев, когда используются эти поля, подпротокол также обеспечивает гарантированную доставку (миссии, параметры, команды).
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION00096000000000000000">
Проверки целостности</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
MAVLink реализует две проверки целостности: первая проверка целостности пакета во время передачи с использованием контрольной суммы X.25 ( <!-- MATH
 $CRC-16-CCITT$
 -->
<SPAN CLASS="MATH">31#31</SPAN> ). Однако это только гарантирует, что данные не были изменены в ссылке &#8211; это не гарантирует согласованности с определением данных. Вторая проверка целостности связана с описанием данных, чтобы убедиться в содержании идентичной информации у двух сообщений с одинаковым идентификатором. Для этого само определение данных проходит через <!-- MATH
 $CRC-16-CCITT$
 -->
<SPAN CLASS="MATH">31#31</SPAN>, а полученное значение используется для заполнения пакета CRC. Большинство эталонных реализаций хранят эту константу в массиве CRC_EXTRA . [#!mavlink!#]
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Библиотека MAVLink позволяет кодировать и раскодировать пакеты согласно протоколу, но она не регламентирует, какими аппаратными и программными средствами данные будет отправлены — это могут быть TCP/UDP сообщения, обмен через последовательный порт, - все, что обеспечивает двухсторонний обмен. Библиотека обрабатывает входные данные побайтово, добавляя их в буфер и сама собирает из них пакет. Каждая система или компонент, может одновременно обмениваться данными по разным источникам, тогда для каждого источника назначается специальный идентификатор, называемый channel (канал). MAVLink содержит буфер на каждый канал.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE"><TT><A NAME="tex2html22"
  HREF="https://habr.com/ru/post/312300/">https://habr.com/ru/post/312300/</A></TT></BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Канал связи
Протокол MAVLink может быть использован поверх следующих каналов связи:
последовательное соединение (UART, USB и др.);
UDP (Wi-Fi, Ethernet, 3G, LTE);
TCP (Wi-Fi, Ethernet, 3G, LTE).
Сообщение
MAVLink-сообщение это отдельная "порция" данных, передаваемая между устройствами. Отдельное MAVLink-сообщение содержит информацию о состоянии дрона или команду для дрона.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">Примеры MAVLink-сообщений:
ATTITUDE, ATTITUDE_QUATERNION – ориентация квадрокоптера в пространстве;
LOCAL_POSITION_NED – локальная позиция квадрокоптера;
GLOBAL_POSITION_INT – глобальная позиция квадрокоптера (широта/долгота/высота);
COMMAND_LONG – команда для квадрокоптера (взлететь, сесть, переключить режим и т. д.).
</BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE"><TT><A NAME="tex2html23"
  HREF="https://clover.coex.tech/ru/mavlink.html">https://clover.coex.tech/ru/mavlink.html</A></TT></BIG></BIG>
<P>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">//замечания следующие:
//осознанно переписать
//подвести итог, чем полезно, как улучшить для наших целей(возможно, одна из задач на следующий семестр) итд
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H1><A NAME="SECTION000100000000000000000">
Создание экспериментального образца</A>
</H1><BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION000101000000000000000">
Сборка квадрокоптера</A>
</H2><BIG CLASS="LARGE"><BIG CLASS="LARGE">
Первым делом, собирается рама, к ней прикручиваются плата регуляторов и моторы. Делается замер нужной длины проводов моторов и лишняя часть отрезается. Далее все фазы каждого мотора припаиваются на соответствующие площадки регуляторов. Также к регуляторам припаиваются силовые провода с коннектором для подключения аккумулятора. Ставится поверх регулятора полетный контроллер, он подключается к регуляторам через колодку. На передние стойки ставятся пластиковые крепления, куда прикручивается камера, размещается видеопередатчик и производится замер длины проводов, которые необходимо подключить к полетному контроллеру (рис. <A HREF="#fig:quad1">10</A>).
</BIG></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:quad1"></A><A NAME="942"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 10.:</STRONG>
Установка компонентов на раму
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="2560" HEIGHT="1440" ALIGN="BOTTOM" BORDER="0"
 SRC="./quad1.jpg"
 ALT="Image quad1"></TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">
После монтажа приемника прикручивается верхняя пластина рамы и на этом сборка завершается (рис. <A HREF="#fig:quad2">11</A>).
</BIG></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:quad2"></A><A NAME="948"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 11.:</STRONG>
Экспериментальный образец квадрокоптера
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="2560" HEIGHT="1440" ALIGN="BOTTOM" BORDER="0"
 SRC="./quad2.jpg"
 ALT="Image quad2"></TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION000102000000000000000">
Сборка наземной станции</A>
</H2><BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION000103000000000000000">
Обновление и настройка параметров прошивки</A>
</H2><BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H2><A NAME="SECTION000104000000000000000">
Проверка работы экспериментального образца</A>
</H2><BIG CLASS="LARGE"></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:map"></A><A NAME="956"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 12.:</STRONG>
Карта маркеров
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="2000" HEIGHT="2000" ALIGN="BOTTOM" BORDER="0"
 SRC="./map.png"
 ALT="Image map"></TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:aruco_detect"></A><A NAME="961"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 13.:</STRONG>
Инициализация aruco маркеров
	</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="1129" HEIGHT="1038" ALIGN="BOTTOM" BORDER="0"
 SRC="./aruco_detect.jpeg"
 ALT="Image aruco_detect"></TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<DIV ALIGN="CENTER"><A NAME="fig:time"></A><A NAME="966"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Рисунок 14.:</STRONG>
Время задержки</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">

</DIV>	<IMG
  WIDTH="1183" HEIGHT="979" ALIGN="BOTTOM" BORDER="0"
 SRC="./time.jpeg"
 ALT="Image time"></TD></TR>
</TABLE>
</DIV>
<BIG CLASS="LARGE"><BIG CLASS="LARGE">
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<H1><A NAME="SECTION000110000000000000000">
<DIV ALIGN="CENTER">

</DIV>ЗАКЛЮЧЕНИЕ</A>
</H1><BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
 
<OL>
<LI>Изучение предметной области
</LI>
<LI>Разработка архитектуры микродрона
</LI>
<LI>Разработка архитектуры наземной станции
</LI>
<LI>Исследование протоколов общения дрона и наземной станции
</LI>
<LI>Создание экспериментального образца
</LI>
</OL><BIG CLASS="LARGE"><BIG CLASS="LARGE">
Разработанный ПАК позволяет &#8212; перечислить основные функциональные характеристики и особенности.
</BIG></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<P>
<BIG CLASS="LARGE"></BIG>
<BR><HR><H4>Примечание</H4>
<DL>
<DT><A NAME="foot249">... комплекты.</A><A
 HREF="NIR_Petrenko.html#tex2html1"><SUP><SPAN CLASS="arabic">1</SPAN></SUP></A></DT>
<DD>Включение робототехники в программу основного общего образования как в виде занятий в рамках внеурочной деятельности, так и в качестве составной части школьного курса технологии полностью соответствует идеям, заложенным в федеральный государственный образовательный стандарт (ФГОС). Согласно приказу Минобрнауки России об утверждении ФГОС ООО, "при итоговом оценивании результатов освоения обучающимися основной образовательной программы основного общего образования должны учитываться сформированность умений выполнения проектной деятельности и способность к решению учебно-практических и учебно-познавательных задач" [#!minobr!#]

</DD>
</DL>
<BR><HR>

</BODY>
</HTML>
